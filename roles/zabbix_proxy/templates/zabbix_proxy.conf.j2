# ==============================================================================
# Template de Configuração do Zabbix Proxy
# Arquivo: roles/zabbix_proxy/templates/zabbix_proxy.conf.j2
# Descrição: Template enxuto para Proxy em modo ATIVO com PSK
# ==============================================================================

### PROXY MODE
ProxyMode=0
ProxyBufferMode={{ zabbix_proxy_buffermode }}
ProxyMemoryBufferSize={{ zabbix_proxy_memory_buffer_size }}
ProxyOfflineBuffer={{ zabbix_proxy_offline_buffer }}
ProxyLocalBuffer={{ zabbix_proxy_proxybuffer }}

### PROXY SERVICE 
Hostname={{ zabbix_proxy_hostname }}
ServerActive={{ zabbix_server_ip }}
ListenPort={{ zabbix_proxy_listenport }}
SourceIP={{ pop_network_ipv4_address | split('/') | first }}

### GENERAL
PidFile={{ zabbix_proxy_pidfile }}
SocketDir={{ zabbix_proxy_socket_dir }}

### PROCESSES
StartPollers={{ zabbix_proxy_startpollers }}
StartPreprocessors={{ zabbix_proxy_startpreprocessors }}
StartPollersUnreachable={{ zabbix_proxy_startpollersunreachable }}
#StartHistoryPollers={{ zabbix_proxy_starthistorypollers }}
StartTrappers={{ zabbix_proxy_starttrappers }}
StartPingers={{ zabbix_proxy_startpingers }}
StartDiscoverers={{ zabbix_proxy_startdiscoverers }}
StartHTTPPollers={{ zabbix_proxy_starthttpollers }}
StartSNMPPollers={{ zabbix_proxy_startsnmppollers }}
StartAgentPollers={{ zabbix_proxy_startagentpollers }}
StartDBSyncers={{ zabbix_proxy_startdbsyncers }}
StartIPMIPollers={{ zabbix_proxy_startipmipollers }}
StartVMwareCollectors={{ zabbix_proxy_startvmwarecollectors }}

### CACHE
CacheSize={{ zabbix_proxy_cachesize }}
HistoryCacheSize={{ zabbix_proxy_historycachesize }}
HistoryIndexCacheSize={{ zabbix_proxy_historyindexcachesize }}

### TLS (PSK)
TLSConnect={{ zabbix_proxy_tls_connect }}
TLSAccept={{ zabbix_proxy_tls_accept }}
TLSPSKIdentity={{ zabbix_proxy_psk_identity }}
TLSPSKFile={{ zabbix_proxy_psk_file }}

### LOG
LogFile={{ zabbix_proxy_logfile }}
LogType={{ zabbix_proxy_logtype }}
LogFileSize={{ zabbix_proxy_logfile_size }}
DebugLevel={{ zabbix_proxy_debug_level }}

### LOCAL DATABASE
DBName={{ zabbix_proxy_dbname }}
ProxyOfflineBuffer={{ zabbix_proxy_offline_buffer }}

### TIMERS
HeartbeatFrequency={{ zabbix_proxy_heartbeat_frequency | default(60) }}
ConfigFrequency={{ zabbix_proxy_config_frequency }}
DataSenderFrequency={{ zabbix_proxy_datasender_frequency }}
HousekeepingFrequency={{ zabbix_proxy_housekeeping_frequency }}
Timeout={{ zabbix_proxy_timeout }}
TrapperTimeout={{ zabbix_proxy_trappertimeout }}
UnreachablePeriod={{ zabbix_proxy_unreachable_period }}
UnavailableDelay={{ zabbix_proxy_unavailable_delay }}
UnreachableDelay={{ zabbix_proxy_unreachable_delay }}

### FPING
FpingLocation={{ zabbix_proxy_fping_location }}
Fping6Location={{ zabbix_proxy_fping6_location }}

### REMOTE COMMANDS
EnableRemoteCommands={{ zabbix_proxy_enable_remote_commands }}
LogRemoteCommands={{ zabbix_proxy_log_remote_commands }}

### DATABASE COMPATIBILITY
AllowUnsupportedDBVersions={{ zabbix_proxy_allow_unsupported_db }}

### SSH KEYS
SSHKeyLocation={{ zabbix_proxy_ssh_key_location }}
