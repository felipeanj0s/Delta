# ==============================================================================
# Template de Configuração do Zabbix Proxy
# Arquivo: roles/zabbix_proxy/templates/zabbix_proxy.conf.j2
# Descrição: Este template gera o arquivo de configuração do Zabbix Proxy,
#            utilizando variáveis globais para garantir consistência.
# ==============================================================================

############ GENERAL PARAMETERS #################

### Option: ProxyMode
#   Proxy operating mode
#   0 - proxy in the active mode
#   1 - proxy in the passive mode
#
# Mandatory: no
# Default:
# ProxyMode=0
ProxyMode={{ zabbix_proxy_mode }}

### Option: Server
#   IP address (or hostname) of Zabbix server.
#   Active proxy will get configuration data from the server.
#   For a proxy in the passive mode this parameter will be ignored.
#
# Mandatory: yes (if ProxyMode is set to 0)
# Default:
# Server=
Server={{ zabbix_server_ip }}

### Option: ServerPort
#   Port of Zabbix trapper on Zabbix server.
#   For a proxy in the passive mode this parameter will be ignored.
#
# Mandatory: no
# Range: 1024-32767
# Default:
# ServerPort=10051
ServerPort=10051

### Option: Hostname
#   Unique, case sensitive Proxy name. Make sure the Proxy name is known to the server!
#   Value is acquired from HostnameItem if undefined.
#
# Mandatory: no
# Default:
# Hostname=
Hostname={{ zabbix_proxy_hostname }}

### Option: DBName
#   Database name.
#   For SQLite3 path to database file must be provided. DBUser and DBPassword are ignored.
#   Warning: do not attempt to use the same database Zabbix server is using.
#
# Mandatory: yes
# Default:
# DBName=
DBName={{ zabbix_proxy_dbname }}

### Option: DebugLevel
#   Specifies debug level
#   0 - no debug
#   1 - critical information
#   2 - error information
#   3 - warnings
#   4 - for debugging (produces lots of information)
#
# Mandatory: no
# Range: 0-4
# Default:
# DebugLevel=3

### Option: LogFile
#   Name of log file.
#   If not set, syslog is used.
#
# Mandatory: no
# Default:
# LogFile=
LogFile={{ zabbix_proxy_logfile }}

### Option: LogFileSize
#   Maximum size of log file in MB.
#   0 - disable automatic log rotation.
#
# Mandatory: no
# Range: 0-1024
# Default:
# LogFileSize=1
LogFileSize={{ zabbix_proxy_logfile_size }}

### Option: PidFile
#   Name of PID file.
#
# Mandatory: no
# Default:
# PidFile=/tmp/zabbix_proxy.pid
PidFile={{ zabbix_proxy_pidfile }}

### Option: HostnameItem
#   Item used for generating Hostname if it is undefined.
#   Ignored if Hostname is defined.
#
# Mandatory: no
# Default:
# HostnameItem=system.hostname

### Option: DBSchema
#   Schema name. Used for IBM DB2.
#
# Mandatory: no
# Default:
# DBSchema=

### Option: DBUser
#   Database user. Ignored for SQLite.
#
# Default:
# DBUser=

### Option: DBPassword
#   Database password. Ignored for SQLite.
#
# Mandatory: no
# Default:
# DBPassword=


######### PROXY SPECIFIC PARAMETERS #############

### Option: ProxyLocalBuffer
#   Proxy will keep data locally for N hours, even if the data have already been synced with the server.
#
# Mandatory: no
# Range: 0-720
# Default:
# ProxyLocalBuffer=0
ProxyLocalBuffer={{ zabbix_proxy_proxybuffer }}

### Option: ProxyOfflineBuffer
#   Proxy will keep data for N hours in case if no connectivity with Zabbix Server.
#   Older data will be lost.
#
# Mandatory: no
# Range: 1-720
# Default:
# ProxyOfflineBuffer=1
ProxyOfflineBuffer={{ zabbix_proxy_offline_buffer }}

### Option: HeartbeatFrequency
#   Frequency of heartbeat messages in seconds.
#   Used for monitoring availability of Proxy on server side.
#
# Mandatory: no
# Range: 0-3600
# Default:
# HeartbeatFrequency=60
HeartbeatFrequency={{ zabbix_proxy_heartbeat_frequency }}

### Option: ConfigFrequency
#   How often proxy retrieves configuration data from Zabbix Server in seconds.
#
# Mandatory: no
# Range: 1-3600*24*7
# Default:
# ConfigFrequency=3600
ConfigFrequency={{ zabbix_proxy_config_frequency }}

### Option: DataSenderFrequency
#   Proxy will send collected data to the Server every N seconds.
#
# Mandatory: no
# Range: 1-3600
# Default:
# DataSenderFrequency=1
DataSenderFrequency={{ zabbix_proxy_datasender_frequency }}


############ ADVANCED PARAMETERS ################

### Option: StartPollers
#   Number of pre-forked instances of pollers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartPollers=5
StartPollers={{ zabbix_proxy_startpollers }}

### Option: StartIPMIPollers
#   Number of pre-forked instances of IPMI pollers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartIPMIPollers=0

### Option: StartPollersUnreachable
#   Number of pre-forked instances of pollers for unreachable hosts (including IPMI).
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartPollersUnreachable=1
StartPollersUnreachable={{ zabbix_proxy_startpollersunreachable }}

### Option: StartTrappers
#   Number of pre-forked instances of trappers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartTrappers=5

### Option: StartPingers
#   Number of pre-forked instances of ICMP pingers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartPingers=1
StartPingers={{ zabbix_proxy_startpingers }}

### Option: StartDiscoverers
#   Number of pre-forked instances of discoverers.
#
# Mandatory: no
# Range: 0-250
# Default:
# StartDiscoverers=1
StartDiscoverers={{ zabbix_proxy_startdiscoverers }}

### Option: StartHTTPPollers
#   Number of pre-forked instances of HTTP pollers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartHTTPPollers=1
StartHTTPPollers={{ zabbix_proxy_starthttpollers }}

### Option: JavaGateway
#   IP address (or hostname) of Zabbix Java gateway.
#
# Mandatory: no
# Default:
# JavaGateway=
JavaGateway={{ zabbix_proxy_javagateway }}

### Option: JavaGatewayPort
#   Port that Zabbix Java gateway listens on.
#
# Mandatory: no
# Range: 1024-32767
# Default:
# JavaGatewayPort=10052
JavaGatewayPort={{ zabbix_proxy_javagatewayport }}

### Option: StartJavaPollers
#   Number of pre-forked instances of Java pollers.
#
# Mandatory: no
# Range: 0-1000
# Default:
# StartJavaPollers=0
StartJavaPollers={{ zabbix_proxy_startjavapollers }}

### Option: SNMPTrapperFile
#   Temporary file used for passing data from SNMP trap daemon to the proxy.
#
# Mandatory: no
# Default:
# SNMPTrapperFile=/tmp/zabbix_traps.tmp

### Option: StartSNMPTrapper
#   If 1, SNMP trapper process is started.
#
# Mandatory: no
# Range: 0-1
# Default:
# StartSNMPTrapper=0

### Option: ListenIP
#   List of comma delimited IP addresses that the trapper should listen on.
#
# Mandatory: no
# Default:
# ListenIP=0.0.0.0
ListenIP={{ zabbix_proxy_listenip }}

### Option: HousekeepingFrequency
#   How often Zabbix will perform housekeeping procedure (in hours).
#
# Mandatory: no
# Range: 1-24
# Default:
# HousekeepingFrequency=1
HousekeepingFrequency={{ zabbix_proxy_housekeeping_frequency }}

### Option: CacheSize
#   Size of configuration cache, in bytes.
#
# Mandatory: no
# Range: 128K-2G
# Default:
# CacheSize=8M
CacheSize={{ zabbix_proxy_cachesize }}

### Option: StartDBSyncers
#   Number of pre-forked instances of DB Syncers
#
# Mandatory: no
# Range: 1-100
# Default:
# StartDBSyncers=4
StartDBSyncers={{ zabbix_proxy_startdbsyncers }}

### Option: HistoryCacheSize
#   Size of history cache, in bytes.
#
# Mandatory: no
# Range: 128K-2G
# Default:
# HistoryCacheSize=8M
HistoryCacheSize={{ zabbix_proxy_historycachesize }}

### Option: HistoryTextCacheSize
#   Size of text history cache, in bytes.
#
# Mandatory: no
# Range: 128K-2G
# Default:
# HistoryTextCacheSize=16M

### Option: Timeout
#   Specifies how long we wait for agent, SNMP device or external check (in seconds).
#
# Mandatory: no
# Range: 1-30
# Default:
# Timeout=3
Timeout={{ zabbix_proxy_timeout }}

### Option: TrapperTimeout
#   Specifies how many seconds trapper may spend processing new data.
#
# Mandatory: no
# Range: 1-300
# Default:
# TrapperTimeout=300

### Option: UnreachablePeriod
#   After how many seconds of unreachability treat a host as unavailable.
#
# Mandatory: no
# Range: 1-3600
# Default:
# UnreachablePeriod=45

### Option: UnavailableDelay
#   How often host is checked for availability during the unavailability period, in seconds.
#
# Mandatory: no
# Range: 1-3600
# Default:
# UnavailableDelay=60

### Option: UnreachableDelay
#   How often host is checked for availability during the unreachability period, in seconds.
#
# Mandatory: no
# Range: 1-3600
# Default:
# UnreachableDelay=15

### Option: ExternalScripts
#   Full path to location of external scripts.
#
# Mandatory: no
# Default:
# ExternalScripts=${datadir}/zabbix/externalscripts

### Option: FpingLocation
#   Location of fping.
#
# Mandatory: no
# Default:
# FpingLocation=/usr/sbin/fping

### Option: Fping6Location
#   Location of fping6.
#
# Mandatory: no
# Default:
# Fping6Location=/usr/sbin/fping6

### Option: SSHKeyLocation
#   Location of public and private keys for SSH checks and actions
#
# Mandatory: no
# Default:
# SSHKeyLocation=

### Option: LogSlowQueries
#   How long a database query may take before being logged (in milliseconds).
#
# Mandatory: no
# Range: 1-3600000
# Default:
# LogSlowQueries=0

### Option: TmpDir
#   Temporary directory.
#
# Mandatory: no
# Default:
# TmpDir=/tmp

### Option: Include
#   You may include individual files or all files in a directory in the configuration file.
#
# Mandatory: no
# Default:
# Include=